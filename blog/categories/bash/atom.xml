<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: bash | jasonwryan.com]]></title>
  <link href="http://jasonwryan.github.com/blog/categories/bash/atom.xml" rel="self"/>
  <link href="http://jasonwryan.github.com/"/>
  <updated>2013-06-22T17:25:39+12:00</updated>
  <id>http://jasonwryan.github.com/</id>
  <author>
    <name><![CDATA[Jason Ryan]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Replacing TrueCrypt]]></title>
    <link href="http://jasonwryan.github.com/blog/2013/01/10/truecrypt/"/>
    <updated>2013-01-10T16:02:00+13:00</updated>
    <id>http://jasonwryan.github.com/blog/2013/01/10/truecrypt</id>
    <content type="html"><![CDATA[<p>{% img left https://dl.dropbox.com/u/261312/Blog-images/lock.jpg 'Flickr image of lock' %}
I have used <a href="http://truecrypt.org/" title="TrueCrypt homepage">TrueCrypt</a> since just before
I migrated to Linux, so somwehere around six or seven years, dating back to version 3 or 4.
It is an incredibly handy utility, allowing you to create and manage encrypted volumes on
the fly and—for the especially paranoid—to hide the existence of those volumes from
inquisitive others.</p>

<p>In the intervening years, with all aspects of my personal life
increasingly mediated digitally, in order to properly safeguard my privacy,
and that of my family, I have taken to using LUKS to
<a href="http://jasonwryan.com/blog/2012/02/11/lvm/" title="Post on LVM on LUKS">fully encrypt all of my machines</a>.
And I have used TrueCrypt, both personally and for work, to encrypt some of my USB drives and as
a container in <a href="http://dropbox.com/" title="Dropbox homepage">Dropbox</a>
, for as long as
<a href="http://jasonwryan.com/blog/2010/01/11/using-dropbox-to-share-dotfiles/" title="Post on sharing dotfiles with Dropbox">I have used that service</a>.</p>

<p>Early last year, however, I became aware of concerns that TrueCrypt was not truly open source; that almost
all of the larger distros, including Arch, and the Open Source Initiative did not regard TrueCrypt as
free (as in Freedom) software:</p>

<p>{% blockquote Wikipedia entry on TrueCrypt https://en.wikipedia.org/wiki/Truecrypt %}
The TrueCrypt License has not been officially approved by the Open Source Initiative and is not considered "free" by several major Linux distributions (Arch Linux, Debian, Ubuntu, Fedora, openSUSE, Gentoo), mainly because of distribution and copyright-liability reasons.
{% endblockquote %}</p>

<p>When I initially accessed the page, in February 2012, there was also a paragraph—now removed—that
highlighted further, more alarmist, concerns about the shadowy identity of the people behind
TrueCrypt:</p>

<p>{% blockquote Wikipedia entry retrieved in February 2012 https://en.wikipedia.org/w/index.php?title=TrueCrypt&amp;diff=478623780&amp;oldid=478608477 %}
The anonymity of the developers and the abnormalities mentioned above have led users to raise suspicions about the provenance of the product and speculate about the possible existence of vulnerabilities or backdoors that might exist in the source code or executables. http://www.privacylover.com/encryption/analysis-is-there-a-backdoor-in-truecrypt-is-truecrypt-a-cia-honeypot/ However its open source and it can be check for funerabilities that way. [sic]
{% endblockquote %}</p>

<p>While I don't subscribe to the theory that the CIA have planted a backdoor in the software (if they
had, <a href="https://en.wikipedia.org/wiki/Truecrypt#Operation_Satyagraha" title="FBI operation foiled by TC">it clearly doesn't work</a>),
I was relieved to see at the end of last year that someone had written a simple utility that allows
you to manage TrueCrypt containers from the command line; <a href="https://github.com/bwalex/tc-play" title="tcplay on Guthub">tcplay</a>
is decribed as:</p>

<p>{% blockquote %}
a free (BSD-licensed), pretty much fully featured (including multiple keyfiles, cipher cascades, etc) and stable TrueCrypt implementation.
{% endblockquote %}</p>

<p>With a <a href="https://github.com/bwalex/tc-play/blob/master/LICENSE" title="tcplay license">simple, two paragraph license</a>
and a brief but comprehensive <code>man</code> page, I was sold. I uninstalled TrueCrypt late last year and haven't missed it since. Quite
the contrary. The only “issue” that I have had with tcplay is remembering the commands to map and mount a drive.
Initially, I jotted down some notes, but opening them up several times a week to refer to them quickly seemed
pointless so I eventually wised up and wrote a wrapper script to do the job for me…</p>

<p>The script is quite simple, it finds the first available loop device, maps the encrypted volume to it and
mounts it read-writeable for your user.</p>

<p>{% codeblock lang:sh %}</p>

<h1>!/bin/bash</h1>

<h1>manage truecrypt containers using tcplay</h1>

<p>user=jason
cryptdev=Safebox
cryptpath=/home/jason/Dropbox/"$cryptdev"
loopdev=$(losetup -f)
mountpt=/media/"$cryptdev"</p>

<h1>must be run as root</h1>

<p>if [[ $EUID != 0 ]]; then
  printf "%s\n" "You must be root to run this."
  exit 1
fi</p>

<h1>unecrypt and mount container</h1>

<p>if [[ "$1" == "open" ]]; then
  losetup "$loopdev" "$cryptpath"
  tcplay --map="$cryptdev" --device="$loopdev"</p>

<p>  # read passphrase
  read -r -s passphrase &lt;&lt;EOF
  "$passphrase"
EOF</p>

<p>  # mount container
  [[ -d "$mountpt" ]] || mkdir "$mountpt"</p>

<p>  # mount options
  userid=$(awk -F"[=(]" '{print $2,$4}' &lt;(id "$user"))
  mount -o nosuid,uid="${userid% <em>}",gid="${userid#</em> }" /dev/mapper/"$cryptdev" "$mountpt"</p>

<h1>close and clean up…</h1>

<p>elif [[ "$1" == "close" ]]; then
  device=$(awk -v dev=$cryptdev -F":" '/dev/ {print $1}' &lt;(losetup -a))
  umount "$mountpt"
  dmsetup remove "$cryptdev" || printf "%s\n" "demapping failed"
  losetup -d "$device" || printf "%s\n" "deleting $loopdev failed"
else
  printf "%s\n" "Options are open or close."
fi
{% endcodeblock %}</p>

<p>Once you are done, the script will unmount your volume and clean up. Undoubtedly, the
script could be improved; patches are welcome.</p>

<p>There is a
<a href="https://aur.archlinux.org/packages/tcplay-git/" title="Arch User Repository">PKGBUILD in the AUR</a>.
Uninstall TrueCrypt and give tcplay a go, it is a simple, powerful application; and it <em>is</em>
free software…</p>

<h4>Notes</h4>

<p>Creative Commons image on Flickr by <a href="http://www.flickr.com/photos/xserve/368758286/" title="Licensed CC by xserv">xserv</a>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Improved Notes Utility]]></title>
    <link href="http://jasonwryan.github.com/blog/2012/09/01/notes-updated/"/>
    <updated>2012-09-01T10:09:00+12:00</updated>
    <id>http://jasonwryan.github.com/blog/2012/09/01/notes-updated</id>
    <content type="html"><![CDATA[<p>{% img left http://dl.dropbox.com/u/261312/Blog-images/notes.jpg 'Notepad image on Flickr' %}
Nearly two years ago, I posted about my adaption of a simple
<a href="http://jasonwryan.com/blog/2010/09/28/command-line-notes/" title="My post in 2010">command line note utility</a>.
I have used this setup on all of my machines on a daily basis since and it has worked
marvellously. Symlinking to a folder in
<a href="https://www.dropbox.com/home" title="Dropbox home">Dropbox</a> means that the notes are accessible
from all my machines, including my phone. There has only really been one aspect of this setup
that has been sub-optimal.</p>

<p>As an inveterate note-taker (this is one of the “benefits” of ageing; the speed with
which you forget information outpaces the acquisition of newer material) I have—in
those intervening years—built up quite a store of notes. Consequently, in order to
maintain a semblance of order, I have arranged them in a series of directories. There
is a minor flaw with this approach: retreiving a note depended on two factors, a) excellent
recall<sup>1</sup> and, b) accurately typing out the full path. Neither of these are things that I
am inherently good at or inclined to master.</p>

<p>This had been irritating me for some time before I came across this
<a href="http://unix.stackexchange.com/questions/11906/how-to-change-the-target-directory-for-tab-completion" title="Tab completion for notes function">question on Unix &amp; Linux StackExchange</a>.
This provided me with a partial solution to the issue but, as I note in my answer, I was not
able to solve it for nested directories, which was my particular use case. Once I had
muddled my way through the solution on U&amp;L I pushed it to the back of my mind and
tried to ignore it.</p>

<p>Recently, though, the accumulation of notes and the frustration of trying to access them
without <kbd>Tab</kbd> completion drove me to do something about it.</p>

<p>The documentation on
<a href="http://www.gnu.org/software/bash/manual/html_node/Programmable-Completion-Builtins.html" title="Bash Manual">programmable completion</a>
is typically terse and searching the web returns very little in the way of instructions
as to how to accomplish this.<sup>2</sup> Undeterred, I decided to hack up a completion
function that worked for nested directories.</p>

<p>What I arrived at was this:
{% codeblock lang:sh %}
shopt -s globstar
shopt -s progcomp</p>

<p>n() { $EDITOR $HOME/.notes/"$*".txt ;}</p>

<p> # completion for notes
_notes() {
local cur
    cur=${COMP_WORDS[COMP_CWORD]}</p>

<pre><code>files=($HOME/.notes/**)
file="${files[@]##*/}"
COMPREPLY=( $( compgen -f "${file[@]}" -- ${cur} ) )
</code></pre>

<p>}
complete -o default -F _notes n
{% endcodeblock %}</p>

<p>The best that can be said about it is that it <em>nearly</em> works…<sup>3</sup></p>

<p>Realising that I was completely out of my depth, I turned to #bash for help, and
I was indeed fortunate that
<a href="https://github.com/geirha" title="geirha's Gitgub">geihra</a> offered some much needed
assistance. geirha's solution is an elegant one:</p>

<p>{% codeblock lang:sh %}
n() {
local arg files=(); for arg; do files+=( ~/".notes/$arg" ); done
${EDITOR:-vi} "${files[@]}"
}</p>

<p>_notes() {
local files=($HOME/.notes/<em>*/"$2"</em>)</p>

<pre><code>[[ -e ${files[0]} ]] &amp;&amp; COMPREPLY=( "${files[@]##~/.notes/}" )
</code></pre>

<p>}
complete -o default -F _notes n
{% endcodeblock %}</p>

<p>In addition to working exactly as I hoped, it had the benefit of introducing me
to a couple more bash concepts that I hadn't encountered;
<a href="http://mywiki.wooledge.org/BashGuide/Arrays" title="Bash Guide on Greg's Wiki">adding elements to an array</a>
with <code>+=()</code> being one. For posterity, the full script is:</p>

<p>{% codeblock lang:sh %}
n() {
local arg files=(); for arg; do files+=( ~/".notes/$arg" ); done
${EDITOR:-vi} "${files[@]}"
}</p>

<p>nls() {
tree -CR --noreport $HOME/.notes | awk '{</p>

<pre><code>if (NF==1) print $1; 
else if (NF==2) print $2; 
else if (NF==3) printf "  %s\n", $3 
}'
</code></pre>

<p>}</p>

<p> # TAB completion for notes
_notes() {
local files=($HOME/.notes/<em>*/"$2"</em>)</p>

<pre><code>[[ -e ${files[0]} ]] &amp;&amp; COMPREPLY=( "${files[@]##~/.notes/}" )
</code></pre>

<p>}
complete -o default -F _notes n
{% endcodeblock %}</p>

<h4>Notes</h4>

<ol>
<li>The alternative to remembering the full path name is to list all of the notes before
each operation with the <code>nls</code> function; this is not ideal either…</li>
<li>Which means that it is either so straightforward that few have bothered to write up their
experiences (most likely), or so arcane that not many have bothered (how it
feels to me). However, there are a couple of pages that I referenced in addition
to the official documentation:

<ul>
<li><a href="http://www.gnu.org/software/bash/manual/html_node/Programmable-Completion-Builtins.html">Adam Backstrong's post</a></li>
<li><a href="http://fahdshariff.blogspot.co.nz/2011/04/writing-your-own-bash-completion.html">Fahd Shariff's post</a></li>
<li><a href="http://devmanual.gentoo.org/tasks-reference/completion/index.html">Gentoo Development Guide</a></li>
</ul>
</li>
<li>It fails, as geirha pointed out, because it breaks the filenames on whitespace.</li>
</ol>


<p>Creative Commons image on Flickr by
<a href="http://www.flickr.com/photos/nicholasjon/4101203095/" title="Field Notes etc on Flickr">nicholasjon</a>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Moving to Octopress]]></title>
    <link href="http://jasonwryan.github.com/blog/2012/03/30/octopress/"/>
    <updated>2012-03-30T12:30:00+13:00</updated>
    <id>http://jasonwryan.github.com/blog/2012/03/30/octopress</id>
    <content type="html"><![CDATA[<p>{% img left http://dl.dropbox.com/u/261312/Blog-images/octopress_logo.png 240 240 Octopress Logo %}</p>

<p>Over the last week I have been moving my blog over to <a href="http://octopress.org/">Octopress</a>,
a lightweight blogging framework for <a href="https://github.com/mojombo/jekyll">Jekyll</a>,
the static site generator powering <a href="http://pages.github.com/">Github Pages</a>. I had previously
been posting to a <a href="https://www.tumblr.com/">tumblr</a> page and, over the nearly four years that
I had been doing that I had somehow racked up just over 4000 posts. I was <em>not</em>
looking forward to migrating across.</p>

<p>However, the fact that the Jekyll project has a number of scripts for
<a href="https://github.com/mojombo/jekyll/wiki/blog-migrations">migrating from other platforms</a>
assuaged my concerns about the difficulty of this task. That sense of relief was shortlived.
Neither of the two tumblr migration scripts were of any assistance: both would die during their
initial runs, probably due to some funky characters in the post titles, or perhaps the posts themselves.</p>

<p>I certainly had no intention of trying to wade through the entire back catalogue identifying the
rogue posts. Rather that admit defeat, and probably more due to a sense of misguided optimism about the
“straightforward” nature of the task, I saw this setback as an opportunity to cull all of the
cruft<sup>1</sup> from the blog and decided to manually import the fifty posts that I thought were of
some interest.</p>

<p>Being an assiduous record keeper, all of the posts were helpfully bookmarked on
<a href="https://pinboard.in/u:jasonwryan/t:jwr/">Pinboard under one tag</a>, and therefore it was
simple enough to create a list of the required <acronym title="Unique Resource Locator">URLs</acronym>.
Armed with this list, it was just a matter of cobbling together a script to do the bulk of
the work for me.</p>

<p>The first task was to retrieve the posts from the list:</p>

<p>{% codeblock lang:sh %}</p>

<h1>grab files</h1>

<p>while read url; do</p>

<pre><code>wget --adjust-extension "${url}"
</code></pre>

<p>done &lt; /home/jason/Scripts/list
{% endcodeblock %}</p>

<p>Then I needed to remove all of the <acronym title="HyperText Markup Language">HTML</acronym>
surrounding the actual posts: an <code>awk</code> one-liner took care of that.</p>

<p>{% codeblock lang:sh %}</p>

<h1>strip HTML cruft</h1>

<p>for file in <em>.html; do
  awk '/<h3>/ {flag=1;next} /&lt;\/div>/{flag=0} flag {print}' "$file" > "${file%%.</em>}"
done
mkdir html &amp;&amp; mv *.html html/
{% endcodeblock %}</p>

<p>The final task of this part of the migration was to convert the HTML into
<a href="http://daringfireball.net/projects/markdown/">markdown</a>,
the format that Octopress uses. <a href="http://johnmacfarlane.net/pandoc/">Pandoc</a>
the "universal document converter" handled that job:</p>

<p>{% codeblock lang:sh %}</p>

<h1>convert to markdown format</h1>

<p>for file in *; do</p>

<pre><code>pandoc -f html -t markdown "$file" &gt; "$file".md
</code></pre>

<p>done
{% endcodeblock %}</p>

<p>The final result was fifty markdown files holding all of my posts, almost ready to
be committed to github. I say “almost” because the files still required what turned out to
be a reasonable amount of cleaning up. Pandoc did a great job, for example, but would
inexpicably break <a href="http://www.notareallink.com">multi word
hyperlinks</a> over two lines. Similarly all of the internal
links to my other posts pointed to the (meaningless) tumblr URLs<sup>2</sup>.</p>

<p>Setting up Octopress was extremely simple and quick by comparison: the
<a href="http://octopress.org/docs/">documentation is very helpful</a>. There was one slight
hitch, a <a href="https://github.com/tmm1/pygments.rb/issues/10">known issue on Arch x86_64</a>,
which was simple enough to deal with.</p>

<p>While the migration was not entirely pain-free, I am pleased that I have done it. Tumblr's service
increasingly <a href="https://twitter.com/#!/jasonwryan/statuses/176543962276954112">left a lot to be desired</a>
but as it was a free service, I couldn't complain too much. Or, more accurately, when I did complain,
no-one actually listened…</p>

<p>Indeed, moving to a paid service like Github
(yes, it's free at first, but once you have enough data there you need to pay a small amount
every month) <a href="http://blog.pinboard.in/2011/12/don_t_be_a_free_user/">makes a lot of sense</a>.
The paid services I do use, like <a href="http://pinboard.in/">Pinboard</a> and
<a href="http://www.tarsnap.com/">Tarsnap</a> are both inexpensive and much more
reliable than their free counterparts<sup>3</sup>; and you get to invest in great
software that is a pleasure to use.</p>

<h5>Notes</h5>

<ol>
<li>Initially, I had set up the site as a simple holding page and dumped a whole lot
of feeds into it: twitter, bookmarks, scrobbled music, etc. Those 4000 posts were
mostly just that sort of internet detritus…</li>
<li>For creating redirections (Github pages do <em>not</em> support <span class="file">.htaccess</span>)
I can't recommend enough the
<a href="https://github.com/rawsyntax/jekyll_alias_generator/blob/master/_plugins/alias_generator.rb">Jekyll Alias Generator</a>.
Just. Brilliant.</li>
<li>And <strong>much</strong> more scrupulous about how they use your personal data.</li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Simple aurphan notifier]]></title>
    <link href="http://jasonwryan.github.com/blog/2012/03/09/aurphan/"/>
    <updated>2012-03-09T16:52:00+13:00</updated>
    <id>http://jasonwryan.github.com/blog/2012/03/09/aurphan</id>
    <content type="html"><![CDATA[<p><img src="http://dl.dropbox.com/u/261312/Blog-images/aurphan.png" alt="image" /></p>

<p>If you are an Arch Linux user and you are not using
<a href="http://www.archlinux.org/packages/community/any/aurphan/" title="aurphan package details">aurphan</a>,
you can take a moment to hang your head in shame before you click on to
whatever the next thing is. The package description sums up perfectly
what aurphan does:</p>

<blockquote><p>Finds packages in need of maintainers, bug fixes and patches. Adopt
today!</p></blockquote>

<p>Running <code>aurphan -a</code>, for example, will identify any
<a href="https://aur.archlinux.org/" title="Arch User Repository">AUR packages</a> in your
database that are not currently maintained; allowing you to log in to
the AUR and hit the ‘Adopt’ button, leaving you feeling all worthy and
fulfilled.<sup>1</sup></p>

<p>If, like most Archers, you have a compulsive desire to automate
<em>everything</em> then clearly typing (or even remembering to type) <code>aurphan
-a</code> into a terminal periodically is as ludicrous as it is onerous. The
obvious answer is some shell script and a cron job.</p>

<p>First, the <code>cron</code> job:</p>

<p>{% codeblock lang:sh %}
crontab -e
@hourly aurphan -a >/tmp/aurphans
{% endcodeblock %}</p>

<p>Then, as part of my
<a href="https://bitbucket.org/jasonwryan/eeepc/src/241da582a0fd/Scripts/dwm-status" title="Script in mercurial repo">dwm-status script</a>,
a function to check that there are no new additions to the file and, if
there are, flash a highlight:</p>

<p>{% codeblock lang:sh %}
aur(){</p>

<pre><code>aurphans="$(awk '$0 !~ /^No /' /tmp/aurphans | wc -l)"
if [ $aurphans -gt 0 ]; then
    echo -en "\x03*\x01"
fi
</code></pre>

<p>}
{% endcodeblock %}</p>

<p>The awk filter excludes a null return, which is “No aurphans found.”
Now, if any of the packages that I use from the AUR are disowned, I’ll
be the first to know about it.</p>

<h5>Notes</h5>

<ol>
<li>Actual feeling may differ depending on the package you have adopted
and the amount of prescription painkillers that you are currently
ingesting…</li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Logging Straight Into X]]></title>
    <link href="http://jasonwryan.github.com/blog/2011/12/18/login/"/>
    <updated>2011-12-18T22:13:00+13:00</updated>
    <id>http://jasonwryan.github.com/blog/2011/12/18/login</id>
    <content type="html"><![CDATA[<p><img src="http://dl.dropbox.com/u/261312/Blog-images/login.png" alt="image" /></p>

<p>I have been using
<a href="https://wiki.archlinux.org/index.php/CDM" title="Arcjh Wiki entry on CDM">CDM</a>
to log into X on my Arch machines and, if I were to continue to require
the ability to access different window managers with any frequency, I
would use this approach. However, on my EeePC, I really only ever login
to a <a href="http://dwm.suckless.org/" title="dwm at suckless.org">dwm</a> session or
the console, so having a login manager seemed like an unnecessary step.</p>

<p>Consequently, over the weekend, with the help of the
<a href="https://wiki.archlinux.org/index.php/Start_X_at_Boot" title="Arch Linux wiki entry">Start X at Boot</a>
article on the Arch Wiki, I removed CDM and arrived at a secure,
flexible approach to logging into X (or the console).</p>

<p>My <span class="file">/etc/inittab</span> already boots me into runlevel 5:</p>

<p>{% codeblock lang:sh %}</p>

<h1>Boot to X11</h1>

<p>id:5:initdefault:
{% endcodeblock %}</p>

<p>So it was just a case of putting a couple of lines in the correct
<a href="http://www.gnu.org/software/bash/manual/bashref.html#Bash-Startup-Files" title="GNU Bash reference: startup files">invocation file</a>.
I chose <span class="file">$HOME/.bash_profile</span> because I only use Bash; if you use another
shell you should probably go with <span class="file">$HOME/.profile</span>. The recommended lines
from the Arch Wiki are:</p>

<p>{% codeblock lang:sh %}
if [[ -z $DISPLAY &amp;&amp; $(tty) = /dev/tty1 ]]; then
  exec startx
  # Could use xinit instead of startx
  #exec xinit -- /usr/bin/X -nolisten tcp vt7
fi
{% endcodeblock %}</p>

<p>…and this works as advertised. If you are in TTY1 and you login, X is
started. The disadvantage for me, though, was that when you shutdown,
you must manually change to TTY7 (if that is your last
<a href="http://tldp.org/HOWTO/Remote-Serial-Console-HOWTO/getty-agetty.html" title="agetty remote serial console">agetty</a>)
to see the shutdown messages.</p>

<p>After rummaging around through various man and web pages, I finally
alighted on this helpful option: <code>-novtswitch</code>. So, my entry to start X
now looked like:</p>

<p>{% codeblock lang:sh %}</p>

<h1>startx if on tty1</h1>

<p>if [[ -z "$DISPLAY" ]] &amp;&amp; [[ $(tty) = /dev/tty1 ]]; then</p>

<pre><code>exec xinit -- :0 -novtswitch &amp;&gt;/dev/null &amp;
logout
</code></pre>

<p>fi
{% endcodeblock %}</p>

<p>Now, on shutdown and reboot, I see all of the shutdown messages. All
that remained was to add an option to log into a tmux session if I
didn’t want to use X. The final code looks like this:</p>

<p>{% codeblock lang:sh ~/.profile %}</p>

<h1>startx if on tty1 and tmux on tty2</h1>

<p>if [[ -z "$DISPLAY" ]] &amp;&amp; [[ $(tty) = /dev/tty1 ]]; then</p>

<pre><code>exec xinit -- :0 -novtswitch &amp;&gt;/dev/null &amp;
logout
</code></pre>

<p>elif [[ $(tty) = /dev/tty2 ]]; then</p>

<pre><code>tmux -f $HOME/.tmux/conf new -s secured
</code></pre>

<p>fi
{% endcodeblock %}</p>

<p>Logging in from TTY1 takes me into my dwm session, if I switch to TTY2 I
am logged into a tmux session with keychain running. To start consolekit
with dwm, I have this in my <span class="file">$HOME/.xinitrc</span>:</p>

<p>{% codeblock lang:sh %}
exec ck-launch-session $HOME/Scripts/dwm-start.
{% endcodeblock %}</p>

<p>You can see my full <span class="file">$HOME/.bash_profile</span> in
<a href="https://bitbucket.org/jasonwryan/eeepc/src/241da582a0fd/.profile" title="profile in mercurial repo">my mercurial repo</a>.</p>

<h4>Updated 4/2/12</h4>

<p>For various reasons, I moved my environment variables from <span class="file">$HOME/.bashrc</span>
into <span class="file">$HOME/.profile</span>; this meant that these variables were only inherited in
interactive shells if <code>xinit</code> was called with <code>exec</code>.</p>

<p>I have also ditched <code>consolekit</code> - for all of the processes it was
spawning, it actually wasn’t performing any critical functions; or
indeed any functions that I really needed at all…</p>
]]></content>
  </entry>
  
</feed>
