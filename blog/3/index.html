
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>jasonwryan.com</title>
  <meta name="author" content="Jason Ryan">

  
  <meta name="description" content="Managing passwords is a necessary evil. You can choose a number of different strategies
for keeping track of all of your login credentials; from &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://jasonwryan.com/blog/3/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="jasonwryan.com" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!-- OpenId login -->
<link rel="openid2.provider" href="https://openid.stackexchange.com/openid/provider">
<link rel="openid2.local_id" href="https://openid.stackexchange.com/user/e970c157-315b-49b2-8b30-1d8a64215d0f">

<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-907012-2']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">jasonwryan.com</a></h1>
  
    <h2>Miscellaneous ephemera…</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://www.duckduckgo.com/" method="get">
  <fieldset role="search">
    <input type="hidden" name="sites" value="jasonwryan.com">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/contact.html">Contact</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/07/25/keepass/">CLI Password Manager</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-07-25T09:36:00+12:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>25</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>9:36 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img class="left" src="/images/post_images/lock.jpg" title="Creative Commons Lock image" >
Managing passwords is a necessary evil. You can choose a number of different strategies
for keeping track of all of your login credentials; from using the same password for every
site which prioritises convenience over <strike>sanity</strike>security, through to
creating heinously complex unique passwords for every service and then balancing the relief
of knowing your risks of being hacked have been minimised with the very real fear you will
only remember any of them for a short period—if at all—and will shortly be locked out of
everything.</p>

<p>Fortunately, this is a solved problem. There are a number of password managers available,
both as desktop clients and cloud services. Personally, I find the idea of storing my
passwords in the cloud has all the fascination of bungee jumping; it&rsquo;s apparently
<a href="http://en.wikipedia.org/wiki/Bungee_jumping#Safety_and_possible_injury" title="Wikipedia page">mostly safe</a>,
but that can be cold comfort… The first application that I used, and used happily for
quite a long time, was
<a href="http://www.keepassx.org/" title="Homepage for KeePassX">KeePassX</a>.</p>

<p>Around the end of 2012, I started experimenting with
<a href="http://raymontag.github.io/keepassc/" title="Homepage">KeePassC</a>, a curses-based password manager
that is completely compatible with KeePassX and has very little in the way of dependencies.
I have been using it solidly on my home and work laptops ever since and, after recently
uninstalling Skype on my desktop, have switched over to it completely<sup>1</sup>.
I&rsquo;m still not entirely clear why I haven&rsquo;t written about it previously.</p>

<p>Written in <a href="https://www.python.org/download/releases/3.0/" title="The New Python">Python 3</a>,
KeePassC is entirely keyboard driven (naturally enough, you can use Vim keybinds) and
integrates seamlessly with your browser and clipboard. My experience of the
software over the last eighteen-odd months is that it has been incredibly stable and
the developer, Karsten-Kai, has been exceptionally responsive and helpful in the
<a href="https://bbs.archlinux.org/viewtopic.php?id=148004" title="Arch BBS thread">forum thread</a>.</p>

<p>Like most good software, there is not a lot to it. You pull up the login page, switch
to a terminal and run <code>keepassc</code>, enter your passphrase (I use a
<a href="http://www.yubico.com/products/yubikey-hardware/yubikey/" title="Yubico site">Yubikey</a>
for this and it works wonderfully) and then search for your desired entry with
<kbd>/</kbd> and then hit <kbd>c</kbd> to copy the password to your clipboard before
switching back to the browser and you are in.</p>

<p>KeePassC also has a set of simple command line options, run <code>keepassc -h</code> to see them.
Additionally, you can set up KeePassC as
<a href="http://raymontag.github.io/keepassc/server.html" title="Server documentation">a server</a>, I haven&rsquo;t
experimented with this as I sync my database. The only functionality that the X application
offers in addition, as far as I can tell, is the auto-filling of your username and password
fields bound to a keybind; undoubtedly, this is a very handy feature, but I haven&rsquo;t
really missed it at all.</p>

<p>As I said, I store the database in a directory synced between all my machines<sup>2</sup> (using
<a href="http://jasonwryan.com/blog/2014/05/10/syncthing/" title="Post on the same">Syncthing</a>),
so I have access to an up-to-date versions of my credentials everywhere. Well, almost
everywhere. I don&rsquo;t use the Android client because the mobile web is just such a
fundamentally <a href="http://en.wikipedia.org/wiki/Mobile_security" title="Wikipedi page">insecure environment</a>
and I see it as just being sensible, rather than any sort of inconvenience.</p>

<h4>Notes</h4>

<ol>
<li>Skype and KeePassX were the only two applications I used that required
<a href="http://qt-project.org/">Qt</a>, so once Skype was gone there was no reason to keep
KeePassX installed.</li>
<li>And, after a nasty scare very early on with a corrupt database, I back that file up
daily.</li>
</ol>


<p>Creative Commons image on Flickr by <a href="http://www.flickr.com/photos/xserve/368758286/" title="Licensed CC by xserv">xserv</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/07/11/aif/">Install scripts</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-07-11T09:49:00+12:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>11</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>9:49 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img class="left" src="/images/post_images/spoons.jpg" title="Creative Commons image of spoons" >
It is now almost exactly two years since the <acronym title="Arch Installer Framework">AIF</acronym>
was <a href="https://www.archlinux.org/news/install-media-20120715-released/" title="Arch News item">put out to pasture</a>.
At the time, it caused a degree of consternation, inexplicably causing some to
believe that it presaged the demise of—if not Arch itself, then certainly the
community around it. And I think it would be fair to say that it was the signal
event that launched a number of spin-offs, the first of which from memory was
Archbang; soon followed by a number of others that promised “Arch Linux with an
easy installation,” or something to that effect…</p>

<p>Of course, if you look back at the Installation Guide immediately before the
move to the new scripts, for example the version that shipped with the last AIF
in
<a href="https://projects.archlinux.org/aif.git/tree/doc/official_installation_guide_en?id=4b075d9cd09b5a0912528bd94ae2a0d4eeb2d7f9" title="In the Git repository">October, 2011</a>, it is pretty evident that
the <a href="https://wiki.archlinux.org/index.php/Installation_guide" title="Installation Guide">current approach</a>
is <em>a lot</em> simpler. Sure, there is no curses <acronym title="Graphic User
Interface">GUI</acronym> to step you through each part of the install but the
introduction of <code>pacstrap</code> and <code>arch-chroot</code> meant that you no longer need those
prompts.</p>

<p>There is also the added advantage that these scripts are useful outside the
installation process itself; they can be used for system maintenance and, in
the rare event that your recent bout of experimentation at 2am after a few
drinks doesn&rsquo;t pan out the way you anticipated, repair.</p>

<p>One of the other responses to the new approach, however, has been the steady
proliferation of “helpful” install scripts. These are essentially bash scripts
that emulate the behaviour of the AIF and walk people through an automated
install of their system. Well, not really their system, more accurately <em>a</em>
system. So you run one of these scripts, answer a few prompts and then, when
you reboot, you have a brand spanking new Arch Linux install running KDE with
the full panoply of software and, in a few special cases, some customized dot
files to “enhance” your experience.</p>

<p>From a certain perspective, I can see how these things appeal. “I wonder if I
could script an entire install, from the partitioning right through to the
desktop environment?” That sounds like a fun project, right? Where it all comes
unstuck, unfortunately, is when the corollary thought appears that suggests
sharing it with the wider community would be a good idea. It is at this point
that a rigorous bout of self-examination about the outcomes that you are
seeking and your base motivations for this act of selflessness are called for.</p>

<p>Whatever those motivations are, whether driven by altruism or the naked desire
for fame and fortune that have—from time to time—alighted on these projects
when they appear on /r/archlinux and the adoring throngs bestow their favours
in equal measures of upvotes and bitcoin, they are grotesquely misplaced. No
good comes from these things, I tell you; none.</p>

<p>Why not? Because, in the guise of being helpful, you are effectively depriving
people of the single most important part of using Arch: building it themselves.
It&rsquo;s like inviting someone to a restaurant for an amazing <em>haute cuisine</em> meal,
sitting them down across the table from you and then them watching as the
staff bring out a mouth-watering array of dishes, each of which you
ostentatiously savour before vomiting it all back into their mouth.</p>

<p>Now, I am sure there is a small minority (well, at least from my own
sheltered experience I imagine it is small) who would
<a href="http://en.wikipedia.org/wiki/Emetophilia" title="Wikipedia: SFW">relish this scenario</a>,
but for most it would qualify as a pretty disappointing date.</p>

<p>Then, after the technicolour <em>table d'hôte</em>, there is the matter of the
clean up. Recently, we had someone show up on the
<a href="http://bbs.archlinux.org" title="Community forums">Arch boards</a> who had
“installed Arch” but who did not understand how to edit a text file;
literally had no clue how to open a file like <span class="file">/etc/fstab</span>
make some changes and then save it. This is beyond stupid; it is a drain
on the goodwill of the community that has to deal with this ineptitude, it
is unfair on people to put them in a position where they feel they are
at the mercy of their technology, rather than in control of it, and it
does nothing to advance the interests of Arch.</p>

<p>If you want to write something like this to improve your scripting skills,
by all means proceed. If you want to contribute to Arch, then pick a
project to contribute to, some bugs to squash, wiki edits, whatever; just
don&rsquo;t publish another one of these idiotic scripts, because you aren&rsquo;t
doing anyone any favours, quite the contrary.</p>

<h4>Notes</h4>

<p>Flickr Creative Commons image, <a href="https://flic.kr/p/dSK6yG">Measuring spoons</a> by
Theen Moy.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/06/28/vpn/">OpenVPN and Time on the Raspberry Pi</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-06-28T09:57:00+12:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>28</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>9:57 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img class="left" src="/images/post_images/raspberry-pi-logo.png" title="Pi logo" >
After relieving my Pi of
<a href="http://jasonwryan.com/blog/2013/06/29/raspberry/" title="Post on Torrent Pi">seedbox duties</a>,
I was looking around for some other use for it. I decided, after looking over
the Arch wiki article on <a href="https://wiki.archlinux.org/index.php/Openvpn" title="Simple, really…">OpenVPN</a>,
that the Pi would be a terrific <acronym title="virtual private network">VPN</acronym>
server; when I am out and about I can access a secure connection to my home
network, thereby significantly reducing the risk of my privacy being
compromised while using connectivity to the Internet provided by the
notoriously security conscious sysadmins that run networks in hotels and
other public places.</p>

<p>Setting it up was straightforward enough, the wiki is typically clear and thorough; the only
bottleneck in the process was waiting for the Pi&rsquo;s tiny chip to chug through the creation of
<a href="https://wiki.archlinux.org/index.php/Create_a_Public_Key_Infrastructure_Using_the_easy-rsa_Scripts" title="Wiki page on the easy-rsa scripts">public keys</a>. Once it was done, and I had tested that it was
indeed working as intended, a more vexing issue presented itself. The service wouldn&rsquo;t come
up after rebooting. Not a deal breaker, I could always just <acronym title="Secure Shell">SSH</acronym>
in and manually bring the server up, but that sort of defeats the purpose of being able to
have the thing running reliably.</p>

<p>The reason that it fails on boot is that, without a hardware clock, the Pi
resets its time to
<a href="https://en.wikipedia.org/wiki/Unix_time" title="Wikipedia article">UNIX time</a>
until the
<a href="https://wiki.archlinux.org/index.php/Ntp" title="Arch wiki page">NTP</a> daemon can
start, which in turn depends upon the network being up. So, after rebooting,
the journal would show the VPN server as having failed as the date was nearly
half a century ago.</p>

<p>There are a variety of fixes floating around, the most amusing being
<a href="http://archlinuxarm.org/forum/viewtopic.php?f=31&amp;t=6037#p34228" title="Yes, really…">a wrapper for init</a>.
Suffice to say, this wasn&rsquo;t an option for me. Looking at the problem logically, it occurred to me
that the issue was actually a trivial one: the correct sequencing of different services
post boot. Isn&rsquo;t this, I asked myself, one of the issues
<a href="http://www.freedesktop.org/wiki/Software/systemd/" title="At freedesktop.org">systemd</a> was supposed
to address?</p>

<p>I just had to ensure that the network came up as quickly as possible after boot, that the time
was reset correctly once there was a viable connection, and that the <code>openvpn.service</code> waited for
those things to happen before launching.</p>

<p>I have fitted the Pi with a wireless dongle, so the first step was to ditch
<a href="https://wiki.archlinux.org/index.php/Netctl" title="Arch wiki page">netctl</a> (the
default network manager on the ARM image) and replace it with
<a href="https://wiki.archlinux.org/index.php/Systemd-networkd" title="More wiki pages for you…">systemd-networkd</a>.
This is the point at which all the wingnuts that think that systemd is some
sort of conspiracy to overthrow the old UNIX gods and replace them with false
idols in <em>chapeau rouge</em> start foaming at their retrognathic mouths about
“viral takeovers” and—seriously what fucking planet do these imbeciles hail
from?—“an abhorrent and violent slap in the face to the Unix
philosophy.”<sup>1</sup></p>

<p>For those of us that accept the theory of evolution, this technology is both
effective and non-threatening; in fact, it is quite an improvement over its by
now ageing predecessor. So, a few minutes later,
<span class="file">/etc/systemd/network/wlan0.network</span> and
<span class="file">/etc/wpa_supplicant/wpa_supplicant-wlan0.conf</span> had pretty much
written themselves and then it was just a matter of enabling the eponymous services
as well as <code>systemd-resolved.service</code>. Reboot and the network is up seemingly
<em>instantly</em>.</p>

<p>Compounding my heresy, I then switched out NTP for
<a href="http://man7.org/linux/man-pages/man8/systemd-timesyncd.8.html" title="Man page">systemd-timesyncd</a>
and the Pi&rsquo;s clock was now reset with the same alacrity. The final piece, ensuring
that the openvpn service waited for this to happen, was to add two lines to the
service file:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>
</span><span class='line'><span class="nv">After</span><span class="o">=</span>network-online.target
</span><span class='line'><span class="nv">Wants</span><span class="o">=</span>network-online.target
</span></code></pre></td></tr></table></div></figure>


<p>That is all there is to it. Reboot and the network comes up, the clock is reset and then
the OpenVPN server starts. Like magic. The sort of heathen magic that threatens to
sap and impurify all of our
<a href="http://www.youtube.com/watch?v=rKR32ImWYzw" title="it's like that…">precious bodily fluids</a>.</p>

<h4>Notes</h4>

<ol>
<li>No, Virginia, I did <a href="http://boycottsystemd.org/">not make that up</a>…
And I don&rsquo;t really understand how you can slap a philosophy in the face, but then
rationality is anathema to zealots; irrespective of which chimæra they
prostrate before.</li>
</ol>

</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/4">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/2">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/01/19/overlayfs/">Playing with overlayfs</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/10/25/snapclean/">Pruning Tarsnap Archives</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/09/20/multiarch/">Multi-arch Packages in AUR</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/09/06/reminder/">Simple Reminders</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/08/23/asp/">Building from Source</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Pinboard</h1>
  <ul id="pinboard_linkroll">Fetching linkroll...</ul>
  <p><a href="http://pinboard.in/u:jasonwryan">My Pinboard Bookmarks &raquo;</a></p>
</section>
<script type="text/javascript">
  var linkroll = 'pinboard_linkroll'; //id target for pinboard list
  var pinboard_user = "jasonwryan"; //id target for pinboard list
  var pinboard_count = 3; //id target for pinboard list
  (function(){
    var pinboardInit = document.createElement('script');
    pinboardInit.type = 'text/javascript';
    pinboardInit.async = true;
    pinboardInit.src = '/javascripts/pinboard.js';
    document.getElementsByTagName('head')[0].appendChild(pinboardInit);
  })();
</script>


<section class="librefm">
<h1>Listening to</h1>
<style type="text/css">
  #librefmList li{ text-align: left; }
</style>
<ul id="librefmList">
  <li class="loading">Updating tracks...</li>
</ul>
<p><a href="https:/libre.fm/user/jasonwryan">My tunes on Libre.fm &raquo;</a></p>

<script lang="Javascript">
    /*
     * JavaScript Pretty Date
     * Copyright (c) 2011 John Resig (ejohn.org)
     * Licensed under the MIT and GPL licenses.
     */

    // Takes an ISO time and returns a string representing how
    // long ago the date represents.
    function prettyDate(time){
        diff = ((new Date()).getTime()/1000 - time),
        day_diff = Math.floor(diff / 86400);

      if ( isNaN(day_diff) || day_diff < 0 || day_diff >= 31 )
        return;

      return day_diff == 0 && (
          diff < 60 && "just now" ||
          diff < 120 && "1 minute" ||
          diff < 3600 && Math.floor( diff / 60 ) + " minutes" ||
          diff < 7200 && "1 hour" ||
          diff < 86400 && Math.floor( diff / 3600 ) + " hours") ||
        day_diff == 1 && "Yesterday" ||
        day_diff < 7 && day_diff + " days" ||
        day_diff < 31 && Math.ceil( day_diff / 7 ) + " weeks";
    }
</script>
<script lang="Javascript">
    function showLibrefmFeed(json){
        if(json.recenttracks == 'undefined'){
            return
        }

        var tracklist = document.getElementById('librefmList'),
            content = '';

        $.each(json.recenttracks.track, function(i, track){
            var interval = prettyDate(track.date['uts']);
            content += '<li id="librefmItem_'+i+'"><a href="'+ track.url + '">' + track.name +'</a> by '+ track.artist['#text'] + '<span class="date"> ' + interval  + ( interval == 'just now' ? '' :' ago') + '</span></li>';
        });

        tracklist.innerHTML = content;
    }
</script>
<script lang="Javascript" src="https://libre.fm/2.0/?method=user.getrecenttracks&user=jasonwryan&page=1&limit=5&format=json&callback=showLibrefmFeed""></script>

</section>

<section>
<p class="arch"><a href="https://unix.stackexchange.com/users/6761/jasonwryan">
<img src="https://stackexchange.com/users/flair/366830.png" border="0" width="208" height="58" alt="profile for jasonwryan at Unix and Linux, Q&amp;A for users of Linux, FreeBSD and other Un*x-like operating systems." title="profile for jasonwryan at Unix and Linux, Q&amp;A for users of Linux, FreeBSD and other Un*x-like operating systems.">
</a></p>
</section>
<section>
<p class="arch"><a href="https://archlinux.org/" title="Arch Linux"><img src="/images/running-on-arch.png" /></a></p>
</section>

  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
All content licensed under <a href="http://creativecommons.org/licenses/by/2.5/" title="Creative Commons by Attribution">Creative Commons</a> 2009-2021 - Jason Ryan    
<span class="credit">This site is powered by <a href="http://vim.org">Vim</a>, <a href="http://octopress.org">Octopress</a> and <a href="http://github.com">Github</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'jasonwryan';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>











</body>
</html>
