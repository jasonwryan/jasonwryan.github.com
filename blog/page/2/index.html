
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>jasonwryan.com</title>
  <meta name="author" content="Jason Ryan">

  
  <meta name="description" content="I posted recently about
my experiences shifting to systemd
and how I found it, for all three of my Arch machines, to be a relatively simple and &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://jasonwryan.github.com/blog/page/2">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="jasonwryan.com" type="application/atom+xml">
  <!-- OpenId login -->
<link rel="openid.server" href="http://openid.claimid.com/server" />
<link rel="openid.delegate" href="http://openid.claimid.com/jasonwryan" />

<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-907012-2']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">jasonwryan.com</a></h1>
  
    <h2>Miscellaneous ephemera…</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://www.duckduckgo.com/" method="get">
  <fieldset role="search">
    <!-- <input type="hidden" name="q" value="site:jasonwryan.github.com" /> -->
    <input type="hidden" name="sites" value="jasonwryan.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search duckduckgo&hellip;"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/contact.html">Contact</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/08/18/trolls/">Trolling Arch Linux</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-08-18T10:47:00+12:00" pubdate data-updated="true">Aug 18<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img class="left" src="http://dl.dropbox.com/u/261312/Blog-images/troll.jpg" title="'Troll on Flickr'" >
I posted recently about
<a href="http://jasonwryan.com/blog/2012/08/04/systemd/" title="Some thoughts on moving across…">my experiences shifting to systemd</a>
and how I found it, for all three of my Arch machines, to be a relatively simple and
straightforward process which, in the intervening weeks, has borne out the views of
the developers and other members of the community who have been using it for a longer
period—it works, and works well. At the start of this week, Stéphane Gaudreault
announced on Arch-dev-public the intention to
<a href="http://mailman.archlinux.org/pipermail/arch-dev-public/2012-August/023389.html" title="ML post seeking developer views">replace the original initscripts with systemd</a>.</p>

<p>The reaction by some to this announcement was, to me, quite disappointing. My view of
open source communities is that by participating you are entering into a social contract.
That contract is that, as you are reliant on the goodwill of the wider community it is
incumbent on you to ensure that your overall contribution—in whatever form—brings
more to the community than it takes away. At the very least, you can strive to ensure
that it is a value neutral exchange.</p>

<p>Sadly, for some of the trolls on the <acronym title="Mailing lists">MLs</acronym>, that
is patently not the case. I want to take a closer look at just one of those threads, for two
reasons. First, it is a textbook case of a particularly pernicious troll. And second, in
conjunction with some other factors, it had an especially damaging effect on the wider
community.</p>

<p>The thread in question is on Arch-general, the largest of the mailing lists. It has
the suitably alarmist title
<a href="http://mailman.archlinux.org/pipermail/arch-general/2012-August/029856.html" title="A trolling we will go…">Think twice before moving to systemd</a>.
The troll, who has had only minimal involvement with the Arch community up until this
unfortunate moment starts by framing his “concern”<sup>1</sup>:</p>

<blockquote><p>I just became aware that Arch Linux plans to switch to systemd, and this worries me for several reasons.</p></blockquote>


<p>Felipe is worried. Ergo, <em>we</em> should be worried. Why should we be worried? Because,
despite the fact that systemd has been discussed and used by Archers since the
<a href="https://bbs.archlinux.org/viewtopic.php?id=96316" title="57 page thread on the Arch BBS">middle of 2010</a>,
it has just come to his attention and now, with the formidable powers of his intellect,
he has detected a disturbance in the force.</p>

<blockquote><p>I tried systemd a while ago in a brand new machine with Arch Linux and the boot was *much slower*. After some exchanges with Lennart Poettering and other people in Google+[1], it became clear I was on my own. Eventually I found the culprit: Fedora uses CONFIG_HZ_1000, and Arch Linux uses CONFIG_HZ_300. It became clear to me that systemd was not ready for prime time, it wasn&#8217;t thoroughly tested in a lot of machines, and if you have problems Lennart Poettering will blame you (PulseAudio sounds familiar?).</p></blockquote>


<p>The salient phrases here are “it became clear I was on my own” and the even more telling,
“it became clear to me that systemd was not ready for prime time.” Once I had managed to
wipe away the tears of gratitude that were coursing down my cheeks, I realized that Arch
finally had finally found what it had been missing for all these years: a saviour. We
were going to be OK after all.</p>

<p>Felipe has “found the culprit.” Despite the best efforts of the Arch developers, upstream,
the other distros that have been using it for considerably longer, and the experience of the
<a href="https://bbs.archlinux.org/viewtopic.php?pid=1147676" title="Thread on systemd - one of many">Arch users reported on our boards</a>,
no-one had the heroic ability to see through to the heart of this conundrum and expose
systemd for the fraud that it is.</p>

<p>But our gratitude should be tempered with some shame for we, the Arch community, have let
Felipe down. We haven&#8217;t lived up to the standards he expects of us. As he gently admonishes us:
“I was expecting more from the Arch Linux community.” Yes, Felipe, and you were right to.
We let you down; can you forgive us?</p>

<p>The thread goes on to generate more than 50 replies. All of them wasted.
His trolling is not interested in facts, in reason or logic; his method of argumentation is
not rational, and he is not interested in working toward an understanding
of the truth; he just wants to be right. At whatever cost to the wider community. These posts,
and trolls in other fora
<a href="https://lkml.org/lkml/2012/4/12/434" title="LKML exchange with Linus Torvalds">like this one</a>,<sup>2</sup>
are really about gratifying Felipe&#8217;s own voracious appetite for self-aggrandisement. In reality,
of course, it is a stunning illustration of the
<a href="https://secure.wikimedia.org/wikipedia/en/wiki/Dunning%E2%80%93Kruger_effect" title="Wikipedia entry">Dunning-Kruger effect</a>.
It would be pathetic if it were a victimless pursuit; but it is not.</p>

<p>Further down in the thread we see the inevitable frustration of the developer who leads
this work for Arch,
<a href="https://www.archlinux.org/developers/#tomegun" title="Tom's developer profile">Tom Gunderson</a>,
finally <a href="http://mailman.archlinux.org/pipermail/arch-general/2012-August/029933.html" title="Tom's reply quoting Linus">boil over</a>.
This precipitates another thread where Tom announces that he will
<a href="http://mailman.archlinux.org/pipermail/arch-general/2012-August/029960.html" title="Tom's mail to the list">no longer participate in this list</a>.
This is from the developer that has patiently and constructively engaged with Arch users on the
list around this issue for the past several months. On his own time.</p>

<p>That is the impact of trolls like Felipe. That is a direct effect of his selfishness on the
wider community. What has he brought to the community? Dissent, distraction and posturing.
What has he taken away? The ability for all of us to engage with one of the developers
of the software we all use. His presence on the list, and that of a few others,
has been nothing short of corrosive.</p>

<p>And as for the smoking gun, the config setting that no-one was smart enough to
discover? Denis A. Altoé Falqueto went to the trouble to build another kernel
and run a test and, contrary to Felipe who provided no such evidence,
<a href="http://mailman.archlinux.org/pipermail/arch-general/2012-August/030145.html" title="Denis' post">posted the results</a>.
You can guess the outcome.</p>

<h4>Notes</h4>

<ol>
<li>See the <a href="http://www.urbandictionary.com/define.php?term=concern+troll">concern troll</a>.</li>
<li>Read the whole thread to fully understand how obstinance can trump reason… See
also his <a href="http://felipec.wordpress.com/2012/05/26/no-mercurial-branches-are-still-not-better-than-git-ones-response-to-jhws-more-on-mercurial-vs-git-with-graphs/">own blog</a>
where he expresses incredulity that his comments on another blog have been deleted.</li>
</ol>


<p>Creative Commons image of the troll on Flickr by
<a href="http://www.flickr.com/photos/56380734@N05/6937763971/">Comrade Foot</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/08/04/systemd/">The Leap to systemd</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-08-04T09:32:00+12:00" pubdate data-updated="true">Aug 4<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img class="left" src="http://dl.dropbox.com/u/261312/Blog-images/leap.jpg" title="Leap image on Flickr" >
I posted a couple of weeks ago about the impact of some of the current
<a href="http://jasonwryan.com/blog/2012/07/19/breakage/" title="Post on the glibc change">changes to Arch Linux</a>.
There seems to be quite a bit of it about, because in conjunction with the move from
<span class="file">/lib</span> to <span class="file">/usr/lib</span>—and motivated by the same
overarching shifts in the other distributions—the other major change making its way through
the Arch community is the move to
<a href="http://freedesktop.org/wiki/Software/systemd" title="Project page">systemd</a>. This change, however, has
been more controversial because it marks a shift away from Arch&#8217;s central configuration
file, <a href="https://wiki.archlinux.org/index.php/Rc.conf" title="Arch wiki entry on rc.conf">/etc/rc.conf</a>;
a move that has disconcerted a number of people.</p>

<p>I&#8217;m not going to get into whether or not this move is consistent with
<a href="https://wiki.archlinux.org/index.php/The_Arch_Way" title="Wiki entry">The Arch Way</a>, because that has
been thrashed over extensively on the
<a href="http://mailman.archlinux.org/pipermail/arch-dev-public/2012-July/023283.html" title="ML thread on rc.conf">mailing</a>
<a href="http://mailman.archlinux.org/pipermail/arch-dev-public/2012-July/023258.html" title="And another one…">lists</a>,
but also—and more importantly—because Arch is a rolling release, which means change is <em>inevitable</em>.
What is more, after watching all the back and forth on the <acronym title="Mailing lists">ML</acronym>
and on the <a href="https://bbs.archlinux.org/viewtopic.php?id=96316&amp;p=1" title="Arch BBS thread on systemd">boards</a>, I am convinced that the
<a href="http://www.archlinux.org/developers/#tomegun" title="Tom Gunderson">developer overseeing this shift</a>
both knows what he is doing and is acting in the best interests of Arch.</p>

<p>This view has been validated by my experience of shifting to systemd on my machines.</p>

<p>When the new initscripts package was pushed to [testing] in the middle of last month,
I stripped out all of the redundant options in <span class="file">/etc/rc.conf</span>
and took the ten minutes or so to read about and then create the new files. I then spent some
time reading up on systemd, principally
<a href="http://0pointer.de/blog/projects/systemd-for-admins-1.html" title="One of TWELVE…">Lennart Poettering&#8217;s series of posts</a>,
the <a href="https://wiki.archlinux.org/index.php/Systemd" title="Good, but needing some structure">Arch wiki entry</a>
and the many and various
<a href="http://0pointer.de/public/systemd-man/" title="One for everything">manual pages</a>.</p>

<p>Over the last couple of days, I have migrated all of my machines over to systemd. I found it
to be a very straightforward process. I went for a pure systemd approach, for reasons I will
return to. Essentially, this is how I tackled it.</p>

<p>First, for each machine, I established what daemons were running. I did this by using
<a href="http://pikacode.com/jasonwryan/Veles/file/default/Scripts/daemons.sh" title="Pretty sure it is one of Xyne's">this shell script</a>
and cross checking entries in my <span class="file">/etc/rc.conf</span>. Then
it was just a matter of installing systemd:<sup>1</sup></p>

<figure class='code'> <div class="highlight"><pre><code class='sh'><span class='line'>sudo pacman -S systemd systemd-sysvcompat systemd-arch-units
</span></code></pre></div></figure>


<p>The only outstanding file to be created was <span class="file">/etc/timezone</span>, the
others—all documented in <code>man rc.conf</code>—I had created earlier in the month. Then, with the
list of the services I would need running on each box, I enabled them. I think it is
fair to say that the only thing that is clunky about systemd is the command syntax for
managing units. Repeatedly typing <code>systemctl enable foo.service</code> is as tedious as it is
error prone, so I hacked up a
<a href="http://pikacode.com/jasonwryan/Centurion/file/default/Scripts/sysd" title="sysd - *so* much easier">wrapper script</a>:</p>

<figure class='code'> <div class="highlight"><pre><code class='sh'><span class='line'>sysd <span class="nb">enable </span>acpid
</span><span class='line'>sysd <span class="nb">enable </span>lvm
</span><span class='line'>etc…
</span></code></pre></div></figure>


<p>I also activated some additional gettys, as I like to log into a tmux session in TTY2 when
I don&#8217;t need or want to start <code>X</code>:</p>

<figure class='code'> <div class="highlight"><pre><code class='sh'><span class='line'>ln -sf /usr/lib/systemd/system/getty@.service /etc/systemd/system/getty.target.wants/getty@tty2.service
</span></code></pre></div></figure>


<p>And I misguidedly wrote a couple of custom service files that turned out to be
<a href="https://bbs.archlinux.org/viewtopic.php?id=146207" title="BBS post on said files">completely unnecessary</a>;
and then I was done.</p>

<p>On all three boxes I rebooted and that was it. The only issue I experienced was
the final shutdown after removing initscripts and before booting up with
systemd. After issuing <code>shutdown -r now</code> the process
hung with a message about a missing <span class="file">inittab</span> file.
In retrospect, I should have added <code>init=/bin/systemd</code> to my kernel parameters
and not unistalled instiscripts until I had booted with systemd. This has
now been added to the
<a href="https://wiki.archlinux.org/index.php/Systemd" title="Archwiki systemd page">systemd wiki page</a>.</p>

<p>Overall, though: no real drama, just a blur of text<sup>2</sup> and then the
login prompt. While I haven&#8217;t seen a dramatic decrease in boot time,
booting does <em>feel</em> a bit snappier and two of my three machines shutdown
markedly more quickly. Consider me sold.</p>

<p>That brings me back to the decision to opt for a pure systemd approach, rather than
hanging on to a completely eviscerated <span class="file">/etc/rc.conf</span>. The
Arch community has been told that the intention is to
<a href="https://bbs.archlinux.org/viewtopic.php?pid=1133957#p1133957" title="BBS post by tomegun">support the rc.conf format forever</a>;
I can&#8217;t help but think this is a mistake. In the same way that
<a href="https://wiki.archlinux.org/index.php/Pacman#Partial_upgrades_are_unsupported" title="Pacman entry on Arch Wiki">partial upgrades are unsupported</a>,
I think that systemd is Arch&#8217;s inevitable future and the community should be encouraged to accept that, <code>Syu</code> and
move on…</p>

<p>Having said that, I appreciate the consideration shown by the developers in wanting to assure
people that their choice would continue to be catered for; and perhaps, over time, people still
using initscripts will be regarded with the same sense of wry amusement as those who still show
up from time to time with <code>hal</code> in their <code>DAEMONS</code> line.</p>

<h3>Update 4/8/12</h3>

<p>Tom Gunderson, the developer who looks after this part of Arch, has clarified the
comment about the long term support for initscripts. As comments are hosted on
a third-party paltform, I thought that it should be included in the body of the
post.</p>

<blockquote><p>Just a clarification: regarding the (probably very unwise) promise of &#8220;supporting <span="file">rc.conf</span> forever&#8221;, the intended meaning was that initscripts will support the syntax, not that initscripts themselves will always stay around (nor that systemd will gain support for the syntax in case initscripts is dropped).</p><p>At the moment systemd <strong>does</strong> support <span class="file">rc.conf</span> (when installed in conjunction with initscripts), but this is meant as a transitional measure only, and will likely go away eventually (though probably not soon).</p></blockquote>


<h4>Notes</h4>

<ol>
<li>Note this approach will <em>remove</em> sysvinit and initscripts and <code>mv /etc/rc.conf{,.pacsave}</code>.</li>
<li>Make sure you remove <code>quiet</code> from your kernel parameters for your first systemd
boot so you can see that everything starts correctly…</li>
</ol>


<p>Creative commons image on Flickr by
<a href="http://www.flickr.com/photos/sovietuk/486119799/" title="leap by rick harrison">Tricky</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/07/26/guards/">Sharing Mercurial Patchsets</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-07-26T18:48:00+12:00" pubdate data-updated="true">Jul 26<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img class="left" src="http://dl.dropbox.com/u/261312/Blog-images/guard.jpg" title="'On Guard image on Flickr'" >
In my last post, on
<a href="http://jasonwryan.com/blog/2012/07/24/queues/" title="You should read it…">Mercurial Queues</a>,
I outlined how you might use MQ to manage a
<a href="http://dwm.suckless.org/" title="Dynamic window manager">dwm</a> patchset.
Mercurial makes this process ridiculously easy, and this functionality is more
than enough to recommend it. However, where I think it really gets interesting
is when you share that same patchset across multiple machines and are easily
able to customize which patches in the queue are applied, based upon the
particular machine you are building dwm on.</p>

<p>For example, in my case I use dwm on all three of my machines: my desktop at home,
my laptop at work and my EeePC. Given the nature of each of these three machines,
though, I want a slightly different stack of patches applied. These differences
might extend only to particular rules applied in <span class="file">config.def.h</span>
based upon the number of tags I use, or the different applications that I run
at home as opposed to at work.</p>

<p>In any event, what I want to be able to do is maintain
<a href="http://pikacode.com/jasonwryan/dwm-patchset/files/default" title="Patchset on Pikacode">a single patchset</a>
in a mercurial repository, clone it to all my machines and then, using MQ,
filter which specific patches are applied. This is all possible using a killer
feature of MQ called
<a href="http://hgbook.red-bean.com/read/advanced-uses-of-mercurial-queues.html%20'Advanced%20uses%20of%20MQ%20in%20the%20Mercurial%20book">guards</a>.
Guards allow you to conditionally apply patches in a queue. Essentially, in
a queue, you “tag” a patch with a guard and—depending on whether or not the
guard is positive (to be applied), or negative (to be skipped)—when you
<code>hg qpush -a</code> MQ takes care of applying the correct patches in the queue.</p>

<p>So, in the case of my work laptop, I begin by cloning dwm and intializing
a patch queue:</p>

<figure class='code'> <div class="highlight"><pre><code class='sh'><span class='line'><span class="nb">cd </span>Build/
</span><span class='line'>hg clone http://hg.suckless.org/dwm
</span><span class='line'>hg qinit -c
</span></code></pre></div></figure>


<p>I setup my <span class="file">.hgrc</span> within the patches directory so that
it points at the correct mercurial repository:</p>

<figure class='code'><figcaption><span>.hg/patches/.hg/hgrc </span></figcaption>
 <div class="highlight"><pre><code class='sh'><span class='line'> <span class="c"># Mercurial config file</span>
</span><span class='line'><span class="o">[</span>ui<span class="o">]</span>
</span><span class='line'><span class="nv">username</span> <span class="o">=</span> jasonwryan &lt;jasonwryan@gmail.com&gt;
</span><span class='line'><span class="nv">ssh</span> <span class="o">=</span> ssh -i ~/.ssh/bb -C
</span><span class='line'><span class="o">[</span>paths<span class="o">]</span>
</span><span class='line'><span class="nv">default</span> <span class="o">=</span> ssh://hg@pikacode.com/jasonwryan/dwm-patchset
</span></code></pre></div></figure>


<p>Then I pull down my dwm patchset from the mercurial repository
with <code>hg pull</code>:</p>

<figure class='code'> <div class="highlight"><pre><code class='sh'><span class='line'>pulling from ssh://hg@pikacode.com/jasonwryan/dwm-patchset
</span><span class='line'>requesting all changes
</span><span class='line'>adding changesets
</span><span class='line'>adding manifests
</span><span class='line'>adding file changes
</span><span class='line'>added 6 changesets with 16 changes to 10 files
</span><span class='line'><span class="o">(</span>run <span class="s1">&#39;hg update&#39;</span> to get a working copy<span class="o">)</span>
</span></code></pre></div></figure>


<p>After I update my local repo,<sup>1</sup> I can see the full patchset with
<code>hg qseries</code>:</p>

<figure class='code'> <div class="highlight"><pre><code class='sh'><span class='line'>setup.makefile
</span><span class='line'>base.config.customizations
</span><span class='line'>statuscolours
</span><span class='line'>cycle
</span><span class='line'>push
</span><span class='line'>bstack
</span><span class='line'>centurion.config
</span></code></pre></div></figure>


<p>Then, as I decribed in my previous post, I make the changes to
<span class="file">config.def.h</span> that are specific to this
machine:</p>

<figure class='code'> <div class="highlight"><pre><code class='sh'><span class='line'>hg qnew veles.config
</span><span class='line'> <span class="c"># “hack, hack, hack…”</span>
</span><span class='line'>hg qrefresh
</span><span class='line'>hg qcommit -m <span class="s1">&#39;Adaptions for Veles&#39;</span>
</span></code></pre></div></figure>


<p>My patchset now has an additional patch in it:</p>

<figure class='code'> <div class="highlight"><pre><code class='sh'><span class='line'>┌─<span class="o">[</span>Veles ~/Build/dwm<span class="o">]</span>
</span><span class='line'>└─╼ hg qseries
</span><span class='line'>setup.makefile
</span><span class='line'>base.config.customizations
</span><span class='line'>statuscolours
</span><span class='line'>cycle
</span><span class='line'>push
</span><span class='line'>bstack
</span><span class='line'>centurion.config
</span><span class='line'>veles.config
</span></code></pre></div></figure>


<p>This is where guards come in to play. If I wasn&#8217;t interested in sharing
the patchset, it would just be a matter of deleting the patch for Centurion.
However, what I want to do is direct MQ to ignore that specific patch
when applying the queue. I do that by creating a negative guard and then
activating it:</p>

<figure class='code'> <div class="highlight"><pre><code class='sh'><span class='line'>hg qguard centurion.config -- -block
</span><span class='line'>hg qselect block
</span><span class='line'>number of unguarded, unapplied patches has changed from 8 to 7
</span></code></pre></div></figure>


<p>That&#8217;s it! Adding a verbose flag to <code>hg qseries</code><sup>2</sup> will print out the
patchset and the accompanying guard status:</p>

<figure class='code'> <div class="highlight"><pre><code class='sh'><span class='line'>┌─<span class="o">[</span>Veles ~/Build/dwm<span class="o">]</span>
</span><span class='line'>└─╼ hg qseries -v
</span><span class='line'>0 U setup.makefile
</span><span class='line'>1 U base.config.customizations
</span><span class='line'>2 U statuscolours
</span><span class='line'>3 U cycle
</span><span class='line'>4 U push
</span><span class='line'>5 U bstack
</span><span class='line'>6 G centurion.config
</span><span class='line'>7 U veles.config
</span></code></pre></div></figure>


<p>The real test, of course, is pushing the patchset onto the fresh
dwm code:</p>

<figure class='code'> <div class="highlight"><pre><code class='sh'><span class='line'>┌─<span class="o">[</span>Veles ~/Build/dwm<span class="o">]</span>
</span><span class='line'>└─╼ hg qpush -a
</span><span class='line'>applying setup.makefile
</span><span class='line'>applying base.config.customizations
</span><span class='line'>applying statuscolours
</span><span class='line'>applying cycle
</span><span class='line'>applying push
</span><span class='line'>applying bstack
</span><span class='line'>skipping centurion.config - guarded by <span class="s1">&#39;-block&#39;</span>
</span><span class='line'>applying veles.config
</span><span class='line'>now at: veles.config
</span></code></pre></div></figure>


<p>How cool is that? One central patchset, applied conditionally depending
upon the machine you are using at the time.</p>

<h4>Notes</h4>

<ol>
<li>Any guards applied on other machines will be present in the newly
pulled <span class="file">series</span> file: these conflicts will need
to be manually merged…</li>
<li>The options for all of the <code>hg</code> commands can be read with
<code>hg -v help $command</code>. For those related to queues, just prepend
a <code>q</code> to <code>$command</code>.</li>
</ol>


<p>Creative Commons image on Flickr by
<a href="http://www.flickr.com/photos/alternatewords/4903560373/" title="On Guard on Flickr">Thorsten Becker</a></p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/3/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/11/20/vimprobable/">A Vimprobable Walkthrough</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/09/28/screencast/">A dwm Screencast</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/09/01/notes-updated/">Improved Notes Utility</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/08/18/trolls/">Trolling Arch Linux</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/08/04/systemd/">The Leap to systemd</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("jasonwryan", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <p><a href="http://twitter.com/jasonwryan">@jasonwryan</a> on Twitter…</p>
  
</section>


<section>
  <h1>My Pinboard</h1>
  <ul id="pinboard_linkroll">Fetching linkroll&#8230;</ul>
  <p><a href="http://pinboard.in/u:jasonwryan">My Pinboard Bookmarks &raquo;</a></p>
</section>
<script type="text/javascript">
  var linkroll = 'pinboard_linkroll'; //id target for pinboard list
  var pinboard_user = "jasonwryan"; //id target for pinboard list
  var pinboard_count = 3; //id target for pinboard list
  (function(){
    var pinboardInit = document.createElement('script');
    pinboardInit.type = 'text/javascript';
    pinboardInit.async = true;
    pinboardInit.src = '/javascripts/pinboard.js';
    document.getElementsByTagName('head')[0].appendChild(pinboardInit);
  })();
</script>


<section class="lastfm">
<h1>Recently Scrobbled</h1>
<style type="text/css">
  #lastfmList li{ text-align: left; }
</style>
<ul id="lastfmList">
  <li class="loading">Updating tracks&#8230;</li>
</ul>
<p><a href="http://alpha.libre.fm/user/jasonwryan">My tunes on Libre.fm &raquo;</a></p>

<script type="text/javascript">
  $.domReady(function(){
    getLastfmFeed("jasonwryan", 5, "3a19a6604d742024a1331bebb7a68d33");
  });
</script>

<script lang="Javascript">
function getLastfmFeed(user,count,api_key) {
  count = parseInt(count, 10);
  $.ajax({
      url: "http://ws.audioscrobbler.com/2.0/?method=user.getrecenttracks&user=" + user + "&limit=" + count + "&api_key=" + api_key
    , type: 'xml'
    , error: function (err) { $('#lastfmList li.loading').addClass('error').text("Last.fm's busted"); }
    , success: function(data) { showLastfmFeed(data); }
  });
}

function showLastfmFeed(xml){
  var tracklist = document.getElementById('lastfmList'),
      content = '',
      i=0;
  
  $(xml.responseXML).find("recenttracks").children().each(function(){
    var artist = $(this).find('artist').text(),
        name = $(this).find('name').text(),
        date = $(this).find('date').text(),
        url = $(this).find('url').text();
    content += '<li id="lastfmItem_'+i+'"><a href="'+ url + '">' + name +'</a> by '+ artist + '<span class="date"> ' + prettyDate(date) + ' ago</span></li>';
    i+=1;
  });

  tracklist.innerHTML = content;
}
</script>
</section>

<section>
<p class="arch"><a href="http://unix.stackexchange.com/users/6761/jasonwryan">
<img src="http://unix.stackexchange.com/users/flair/6761.png" border="0" width="208" height="58" alt="profile for jasonwryan at Unix and Linux, Q&amp;A for users of Linux, FreeBSD and other Un*x-like operating systems." title="profile for jasonwryan at Unix and Linux, Q&amp;A for users of Linux, FreeBSD and other Un*x-like operating systems.">
</a></p>
</section>
<section>
<p class="arch"><a href="https://archlinux.org/" title="Arch Linux"><img src="http://dl.dropbox.com/u/261312/running-on-arch.png" /></a></p>
</section>

  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
All content licensed under <a href="http://creativecommons.org/licenses/by/2.5/" title="Creative Commons by Attribution">Creative Commons</a> 2012 - Jason Ryan    
<span class="credit">This site is powered by <a href="http://vim.org">Vim</a>, <a href="http://octopress.org">Octopress</a> and <a href="http://github.com">Github</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'jasonwryan';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>











</body>
</html>
